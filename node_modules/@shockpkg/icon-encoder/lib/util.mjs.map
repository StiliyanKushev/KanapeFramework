{"version":3,"sources":["util.ts"],"names":["pngIhdr","data","toString","Error","offset","length","size","readUInt32BE","name","d","slice","width","height","bitDepth","readUInt8","colorType","compressionMethod","filterMethod","interlacemethod"],"mappings":"AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASA,OAAT,CAAiBC,IAAjB,EAAmD;AACzD,MAAIA,IAAI,CAACC,QAAL,CAAc,OAAd,EAAuB,CAAvB,EAA0B,CAA1B,MAAiC,iBAArC,EAAwD;AACvD,UAAM,IAAIC,KAAJ,CAAU,8BAAV,CAAN;AACA,GAHwD,CAKzD;;;AACA,MAAIC,MAAM,GAAG,CAAb;;AACA,SAAOA,MAAM,GAAGH,IAAI,CAACI,MAArB,EAA6B;AAC5B,UAAMC,IAAI,GAAGL,IAAI,CAACM,YAAL,CAAkBH,MAAlB,CAAb;AACAA,IAAAA,MAAM,IAAI,CAAV;AACA,UAAMI,IAAI,GAAGP,IAAI,CAACC,QAAL,CAAc,OAAd,EAAuBE,MAAvB,EAA+BA,MAAM,GAAG,CAAxC,CAAb;AACAA,IAAAA,MAAM,IAAI,CAAV;;AACA,QAAII,IAAI,KAAK,MAAb,EAAqB;AACpB,YAAMC,CAAC,GAAGR,IAAI,CAACS,KAAL,CAAWN,MAAX,EAAmBA,MAAM,GAAGE,IAA5B,CAAV;AACA,aAAO;AACNK,QAAAA,KAAK,EAAEF,CAAC,CAACF,YAAF,CAAe,CAAf,CADD;AAENK,QAAAA,MAAM,EAAEH,CAAC,CAACF,YAAF,CAAe,CAAf,CAFF;AAGNM,QAAAA,QAAQ,EAAEJ,CAAC,CAACK,SAAF,CAAY,CAAZ,CAHJ;AAINC,QAAAA,SAAS,EAAEN,CAAC,CAACK,SAAF,CAAY,CAAZ,CAJL;AAKNE,QAAAA,iBAAiB,EAAEP,CAAC,CAACK,SAAF,CAAY,EAAZ,CALb;AAMNG,QAAAA,YAAY,EAAER,CAAC,CAACK,SAAF,CAAY,EAAZ,CANR;AAONI,QAAAA,eAAe,EAAET,CAAC,CAACK,SAAF,CAAY,EAAZ;AAPX,OAAP;AASA;;AACDV,IAAAA,MAAM,IAAIE,IAAV;AACA;;AAED,QAAM,IAAIH,KAAJ,CAAU,sBAAV,CAAN;AACA","sourcesContent":["import {IPngIhdr} from './types';\n\n/**\n * Read PNG IHDR data.\n *\n * @param data PNG data.\n * @returns PNG IHDR.\n */\nexport function pngIhdr(data: Readonly<Buffer>): IPngIhdr {\n\tif (data.toString('ascii', 0, 8) !== '\\tPNG\\r\\n\\x1a\\n') {\n\t\tthrow new Error('Invalid PNG header signature');\n\t}\n\n\t// Seek out IHDR tag, which should be first (spec requires, some ignore).\n\tlet offset = 8;\n\twhile (offset < data.length) {\n\t\tconst size = data.readUInt32BE(offset);\n\t\toffset += 4;\n\t\tconst name = data.toString('ascii', offset, offset + 4);\n\t\toffset += 4;\n\t\tif (name === 'IHDR') {\n\t\t\tconst d = data.slice(offset, offset + size);\n\t\t\treturn {\n\t\t\t\twidth: d.readUInt32BE(0),\n\t\t\t\theight: d.readUInt32BE(4),\n\t\t\t\tbitDepth: d.readUInt8(8),\n\t\t\t\tcolorType: d.readUInt8(9),\n\t\t\t\tcompressionMethod: d.readUInt8(10),\n\t\t\t\tfilterMethod: d.readUInt8(11),\n\t\t\t\tinterlacemethod: d.readUInt8(12)\n\t\t\t};\n\t\t}\n\t\toffset += size;\n\t}\n\n\tthrow new Error('Missing PNG IHDR tag');\n}\n"],"file":"util.mjs","sourceRoot":"../src"}